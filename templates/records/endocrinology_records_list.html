{% extends 'includes/base.html' %}
{% load static %}

{% block title %}Endocrinology Records{% endblock %}

{% block use_dna_left %}
<canvas id="dna-left" class="dna-canvas left"></canvas>
{% endblock %}

{% block use_container %}
<section class="hero-section position-relative">
  <div class="container page-container position-relative text-white text-center mt-2">
    <h2 class="fancy-text mb-3">Endocrinology Records</h2>
    {% include 'includes/messages.html' %}

    {% if records %}
      <div class="row justify-content-center">
        <div class="col-lg-10 col-xl-9">

          <div class="d-flex justify-content-end mb-3">
            <a href="{% url 'add_endocrinology_record' %}"
               class="btn register-btn-glow-alt btn-sm px-3"
               aria-label="Add new endocrinology record"
               title="Add new record">
              Add New Record
            </a>
          </div>

          <div class="table-responsive">
            <table class="table glass-table text-center align-middle">
              <thead>
                <tr class="table-header">
                  <th>Date</th>
                  <th>Time</th>
                  <th>Blood Sugar</th>
                  <th>Notes</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                {% for record in records %}
                  <tr>
                    <td>{{ record.date|date:"M. j, Y" }}</td>
                    <td>{{ record.time|time:"g:i a" }}</td>
                    <td>{{ record.blood_sugar|default:"–" }}</td>
                    <td>{{ record.notes|default:"–" }}</td>
                    <td>
                      <a href="{% url 'edit_endocrinology_record' record.pk %}"
                         class="btn btn-sm btn-outline-warning me-1"
                         title="Edit">
                        <i class="fas fa-pen"></i>
                      </a>
                      <a href="{% url 'delete_endocrinology_record' record.pk %}"
                         class="btn btn-sm btn-outline-danger"
                         title="Delete">
                        <i class="fas fa-trash"></i>
                      </a>
                    </td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>

          {% if is_paginated %}
            <nav aria-label="Pagination" class="mt-4">
              <div class="d-inline-flex flex-wrap justify-content-center align-items-center gap-2 glass-card px-4 py-2 rounded-4 shadow-sm">

                {% if page_obj.has_previous %}
                  <a class="btn btn-sm btn-glow-blue px-3" href="?page=1" title="First Page">&laquo;</a>
                  <a class="btn btn-sm btn-glow-blue px-3" href="?page={{ page_obj.previous_page_number }}" title="Previous Page">&lsaquo;</a>
                {% endif %}

                <span class="btn btn-sm px-3 fw-bold text-white border border-light rounded-3">
                  Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
                </span>

                {% if page_obj.has_next %}
                  <a class="btn btn-sm btn-glow-blue px-3" href="?page={{ page_obj.next_page_number }}" title="Next Page">&rsaquo;</a>
                  <a class="btn btn-sm btn-glow-blue px-3" href="?page={{ page_obj.paginator.num_pages }}" title="Last Page">&raquo;</a>
                {% endif %}

              </div>
            </nav>
          {% endif %}
        </div>
      </div>
    {% else %}
      <div class="alert alert-info mt-4">No records yet.</div>
      <a href="{% url 'add_endocrinology_record' %}" class="btn register-btn-glow-alt mt-3">
        Add Your First Record
      </a>
    {% endif %}
  </div>
</section>
{% endblock %}
